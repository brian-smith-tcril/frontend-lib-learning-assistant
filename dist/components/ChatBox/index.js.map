{"version":3,"file":"index.js","names":["_react","_interopRequireWildcard","require","_reactRedux","_Message","_interopRequireDefault","_MessageDivider","_scroll","_jsxRuntime","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","isToday","date","today","Date","getDate","getMonth","getFullYear","ChatBox","firstRender","useRef","messageContainerRef","messageList","apiIsLoading","useSelector","state","learningAssistant","messagesBeforeToday","filter","m","timestamp","messagesToday","useEffect","current","scrollToBottom","length","jsxs","className","children","ref","map","_ref","role","content","jsx","variant","message","text","_ref2","_default","exports"],"sources":["../../../src/components/ChatBox/index.jsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport Message from '../Message';\nimport './ChatBox.scss';\nimport MessageDivider from '../MessageDivider';\nimport { scrollToBottom } from '../../utils/scroll';\n\nfunction isToday(date) {\n  const today = new Date();\n  return (\n    date.getDate() === today.getDate()\n    && date.getMonth() === today.getMonth()\n    && date.getFullYear() === today.getFullYear()\n  );\n}\n\n// container for all of the messages\nconst ChatBox = () => {\n  const firstRender = useRef(true);\n  const messageContainerRef = useRef();\n\n  const { messageList, apiIsLoading } = useSelector(state => state.learningAssistant);\n  const messagesBeforeToday = messageList.filter((m) => (!isToday(new Date(m.timestamp))));\n  const messagesToday = messageList.filter((m) => (isToday(new Date(m.timestamp))));\n\n  useEffect(() => {\n    if (firstRender.current) {\n      scrollToBottom(messageContainerRef);\n      firstRender.current = false;\n      return;\n    }\n\n    scrollToBottom(messageContainerRef, true);\n  }, [messageList.length]);\n\n  return (\n    <div className=\"xpert-chat-scroller\">\n      <div className=\"messages-list d-flex flex-column\" ref={messageContainerRef} data-testid=\"messages-container\">\n        {messagesBeforeToday.map(({ role, content, timestamp }) => (\n          <Message key={timestamp} variant={role} message={content} />\n        ))}\n        {/* Message divider should not display if no messages or if all messages sent today. */}\n        {(messageList.length !== 0 && messagesBeforeToday.length !== 0) && (<MessageDivider text=\"Today\" />)}\n        {messagesToday.map(({ role, content, timestamp }) => (\n          <Message key={timestamp} variant={role} message={content} />\n        ))}\n        {apiIsLoading && (\n        <div className=\"loading\">Xpert is thinking</div>\n        )}\n      </div>\n      <span className=\"separator separator--top\" />\n      <span className=\"separator separator--bottom\" />\n    </div>\n  );\n};\n\nexport default ChatBox;\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,uBAAA,CAAAC,OAAA;AACA,IAAAC,WAAA,GAAAD,OAAA;AACA,IAAAE,QAAA,GAAAC,sBAAA,CAAAH,OAAA;AACAA,OAAA;AACA,IAAAI,eAAA,GAAAD,sBAAA,CAAAH,OAAA;AACA,IAAAK,OAAA,GAAAL,OAAA;AAAoD,IAAAM,WAAA,GAAAN,OAAA;AAAA,SAAAG,uBAAAI,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAAA,SAAAG,yBAAAC,CAAA,6BAAAC,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,CAAA,WAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA,KAAAF,CAAA;AAAA,SAAAZ,wBAAAY,CAAA,EAAAE,CAAA,SAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAH,UAAA,SAAAG,CAAA,eAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,WAAAF,OAAA,EAAAE,CAAA,QAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAC,GAAA,CAAAJ,CAAA,UAAAG,CAAA,CAAAE,GAAA,CAAAL,CAAA,OAAAM,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAZ,CAAA,oBAAAY,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAd,CAAA,EAAAY,CAAA,SAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAX,CAAA,EAAAY,CAAA,UAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAZ,CAAA,CAAAY,CAAA,YAAAN,CAAA,CAAAR,OAAA,GAAAE,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAa,GAAA,CAAAhB,CAAA,EAAAM,CAAA,GAAAA,CAAA;AAEpD,SAASW,OAAOA,CAACC,IAAI,EAAE;EACrB,MAAMC,KAAK,GAAG,IAAIC,IAAI,CAAC,CAAC;EACxB,OACEF,IAAI,CAACG,OAAO,CAAC,CAAC,KAAKF,KAAK,CAACE,OAAO,CAAC,CAAC,IAC/BH,IAAI,CAACI,QAAQ,CAAC,CAAC,KAAKH,KAAK,CAACG,QAAQ,CAAC,CAAC,IACpCJ,IAAI,CAACK,WAAW,CAAC,CAAC,KAAKJ,KAAK,CAACI,WAAW,CAAC,CAAC;AAEjD;;AAEA;AACA,MAAMC,OAAO,GAAGA,CAAA,KAAM;EACpB,MAAMC,WAAW,GAAG,IAAAC,aAAM,EAAC,IAAI,CAAC;EAChC,MAAMC,mBAAmB,GAAG,IAAAD,aAAM,EAAC,CAAC;EAEpC,MAAM;IAAEE,WAAW;IAAEC;EAAa,CAAC,GAAG,IAAAC,uBAAW,EAACC,KAAK,IAAIA,KAAK,CAACC,iBAAiB,CAAC;EACnF,MAAMC,mBAAmB,GAAGL,WAAW,CAACM,MAAM,CAAEC,CAAC,IAAM,CAAClB,OAAO,CAAC,IAAIG,IAAI,CAACe,CAAC,CAACC,SAAS,CAAC,CAAE,CAAC;EACxF,MAAMC,aAAa,GAAGT,WAAW,CAACM,MAAM,CAAEC,CAAC,IAAMlB,OAAO,CAAC,IAAIG,IAAI,CAACe,CAAC,CAACC,SAAS,CAAC,CAAE,CAAC;EAEjF,IAAAE,gBAAS,EAAC,MAAM;IACd,IAAIb,WAAW,CAACc,OAAO,EAAE;MACvB,IAAAC,sBAAc,EAACb,mBAAmB,CAAC;MACnCF,WAAW,CAACc,OAAO,GAAG,KAAK;MAC3B;IACF;IAEA,IAAAC,sBAAc,EAACb,mBAAmB,EAAE,IAAI,CAAC;EAC3C,CAAC,EAAE,CAACC,WAAW,CAACa,MAAM,CAAC,CAAC;EAExB,oBACE,IAAA9C,WAAA,CAAA+C,IAAA;IAAKC,SAAS,EAAC,qBAAqB;IAAAC,QAAA,gBAClC,IAAAjD,WAAA,CAAA+C,IAAA;MAAKC,SAAS,EAAC,kCAAkC;MAACE,GAAG,EAAElB,mBAAoB;MAAC,eAAY,oBAAoB;MAAAiB,QAAA,GACzGX,mBAAmB,CAACa,GAAG,CAACC,IAAA;QAAA,IAAC;UAAEC,IAAI;UAAEC,OAAO;UAAEb;QAAU,CAAC,GAAAW,IAAA;QAAA,oBACpD,IAAApD,WAAA,CAAAuD,GAAA,EAAC3D,QAAA,CAAAO,OAAO;UAAiBqD,OAAO,EAAEH,IAAK;UAACI,OAAO,EAAEH;QAAQ,GAA3Cb,SAA6C,CAAC;MAAA,CAC7D,CAAC,EAEAR,WAAW,CAACa,MAAM,KAAK,CAAC,IAAIR,mBAAmB,CAACQ,MAAM,KAAK,CAAC,iBAAM,IAAA9C,WAAA,CAAAuD,GAAA,EAACzD,eAAA,CAAAK,OAAc;QAACuD,IAAI,EAAC;MAAO,CAAE,CAAE,EACnGhB,aAAa,CAACS,GAAG,CAACQ,KAAA;QAAA,IAAC;UAAEN,IAAI;UAAEC,OAAO;UAAEb;QAAU,CAAC,GAAAkB,KAAA;QAAA,oBAC9C,IAAA3D,WAAA,CAAAuD,GAAA,EAAC3D,QAAA,CAAAO,OAAO;UAAiBqD,OAAO,EAAEH,IAAK;UAACI,OAAO,EAAEH;QAAQ,GAA3Cb,SAA6C,CAAC;MAAA,CAC7D,CAAC,EACDP,YAAY,iBACb,IAAAlC,WAAA,CAAAuD,GAAA;QAAKP,SAAS,EAAC,SAAS;QAAAC,QAAA,EAAC;MAAiB,CAAK,CAC9C;IAAA,CACE,CAAC,eACN,IAAAjD,WAAA,CAAAuD,GAAA;MAAMP,SAAS,EAAC;IAA0B,CAAE,CAAC,eAC7C,IAAAhD,WAAA,CAAAuD,GAAA;MAAMP,SAAS,EAAC;IAA6B,CAAE,CAAC;EAAA,CAC7C,CAAC;AAEV,CAAC;AAAC,IAAAY,QAAA,GAAAC,OAAA,CAAA1D,OAAA,GAEa0B,OAAO","ignoreList":[]}